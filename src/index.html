<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Regenerative Health Patient Questionnaire</title>
		<script src="https://cdn.tailwindcss.com"></script>
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap"
			rel="stylesheet" />
		<style>
			body {
				font-family: "Inter", sans-serif;
				background-color: #f3f4f6;
			}
		</style>
	</head>
	<body class="bg-gray-100 p-4 sm:p-8">
		<div
			class="max-w-4xl mx-auto bg-white shadow-xl rounded-2xl p-6 sm:p-10">
			<header class="text-center mb-8 sm:mb-12">
				<h1 class="text-3xl sm:text-4xl font-bold text-gray-800">
					Regenerative Health
				</h1>
				<h2
					class="text-xl sm:text-2xl font-semibold text-green-600 mt-2">
					Patient Questionnaire
				</h2>
				<p class="text-gray-500 mt-4">
					Please fill out this form to help us understand your health
					concerns and create a personalized treatment plan.
				</p>
			</header>

			<form
				id="healthQuestionnaire"
				onsubmit="handleFormSubmit(event)"
				class="space-y-8">
				<!-- Personal Information Section -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Patient Information
					</h3>
					<div class="grid grid-cols-1 sm:grid-cols-2 gap-6">
						<div>
							<label
								for="fullName"
								class="block text-sm font-medium text-gray-700"
								>Full Name</label
							>
							<input
								type="text"
								id="fullName"
								name="fullName"
								required
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150" />
						</div>
						<div>
							<label
								for="dob"
								class="block text-sm font-medium text-gray-700"
								>Date of Birth</label
							>
							<input
								type="date"
								id="dob"
								name="dob"
								required
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150" />
						</div>
						<div>
							<label
								for="phone"
								class="block text-sm font-medium text-gray-700"
								>Phone Number</label
							>
							<input
								type="tel"
								id="phone"
								name="phone"
								required
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150" />
						</div>
						<div>
							<label
								for="email"
								class="block text-sm font-medium text-gray-700"
								>Email Address</label
							>
							<input
								type="email"
								id="email"
								name="email"
								required
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150" />
						</div>
					</div>
				</section>

				<!-- Health Concerns Section -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Your Health Concerns
					</h3>
					<div>
						<label
							for="mainComplaint"
							class="block text-sm font-medium text-gray-700"
							>What is your main reason for seeking care?</label
						>
						<textarea
							id="mainComplaint"
							name="mainComplaint"
							rows="3"
							required
							class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
					</div>
				</section>

				<!-- Symptoms and Areas of Concern -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Symptoms and Areas of Concern
					</h3>
					<p class="text-sm text-gray-500 mb-4">
						For each concern, please describe the symptom and its
						severity. Severity is a measure of how much this concern
						affects your daily life.
					</p>

					<div id="painPointsContainer" class="space-y-6">
						<!-- Area of Concern 1 -->
						<div
							class="bg-gray-50 p-4 rounded-lg border border-gray-200 shadow-sm">
							<div class="flex justify-between items-center mb-4">
								<h4 class="font-medium text-gray-700">
									Area of Concern #1
								</h4>
								<button
									type="button"
									onclick="removePainPoint(this)"
									class="text-red-500 hover:text-red-700 text-sm font-medium">
									Remove
								</button>
							</div>
							<div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
								<div>
									<label
										class="block text-sm font-medium text-gray-700"
										>Area of Symptom/Condition</label
									>
									<input
										type="text"
										name="painArea[]"
										required
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150" />
								</div>
								<div>
									<label
										class="block text-sm font-medium text-gray-700"
										>Severity Level (0-10)</label
									>
									<input
										type="range"
										name="painLevel[]"
										min="0"
										max="10"
										value="0"
										oninput="this.nextElementSibling.value = this.value"
										class="w-full mt-2" />
									<output
										class="text-center block text-sm font-mono mt-1"
										>0</output
									>
								</div>
								<div class="col-span-1 sm:col-span-2">
									<label
										class="block text-sm font-medium text-gray-700"
										>Describe the symptom or
										condition</label
									>
									<textarea
										name="painDescription[]"
										rows="2"
										class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
								</div>
							</div>
						</div>
					</div>
					<button
						type="button"
						onclick="addPainPoint()"
						class="mt-6 w-full sm:w-auto px-6 py-2 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150">
						Add another concern
					</button>
				</section>

				<!-- Mobility and Functional Limitations -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Mobility and Functional Limitations
					</h3>
					<div class="space-y-6">
						<div>
							<label
								for="mobilityIssues"
								class="block text-sm font-medium text-gray-700"
								>Do you have difficulty with any of the
								following activities? (e.g., walking, climbing
								stairs, standing for long periods, bending,
								lifting)</label
							>
							<textarea
								id="mobilityIssues"
								name="mobilityIssues"
								rows="3"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
						<div>
							<label
								for="sportsActivities"
								class="block text-sm font-medium text-gray-700"
								>Do you participate in any sports or physical
								activities? If so, which ones and how are they
								impacted by your symptoms?</label
							>
							<textarea
								id="sportsActivities"
								name="sportsActivities"
								rows="3"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
					</div>
				</section>

				<!-- Lifestyle and Medical History Section -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Lifestyle and Medical History
					</h3>
					<div class="space-y-6">
						<div>
							<label
								for="sleepQuality"
								class="block text-sm font-medium text-gray-700"
								>On average, how many hours of sleep do you get
								per night? How would you rate your sleep
								quality?</label
							>
							<textarea
								id="sleepQuality"
								name="sleepQuality"
								rows="2"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
						<div>
							<label
								for="diet"
								class="block text-sm font-medium text-gray-700"
								>Please describe your general dietary habits and
								water intake.</label
							>
							<textarea
								id="diet"
								name="diet"
								rows="2"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
						<div>
							<label
								for="allergies"
								class="block text-sm font-medium text-gray-700"
								>Do you have any known allergies?</label
							>
							<textarea
								id="allergies"
								name="allergies"
								rows="2"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
						<div>
							<label
								for="pastMedicalHistory"
								class="block text-sm font-medium text-gray-700"
								>Please list any significant past medical
								history (e.g., surgeries, diagnoses,
								hospitalizations).</label
							>
							<textarea
								id="pastMedicalHistory"
								name="pastMedicalHistory"
								rows="3"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
						<div>
							<label
								for="medications"
								class="block text-sm font-medium text-gray-700"
								>Please list all current medications,
								supplements, and dosages.</label
							>
							<textarea
								id="medications"
								name="medications"
								rows="3"
								class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
						</div>
					</div>
				</section>

				<!-- Consent & Signature -->
				<section>
					<h3
						class="text-xl font-semibold text-gray-700 border-b border-gray-200 pb-2 mb-4">
						Consent and Acknowledgment
					</h3>
					<div class="flex items-start">
						<div class="flex items-center h-5">
							<input
								id="consent"
								name="consent"
								type="checkbox"
								required
								class="focus:ring-green-500 h-4 w-4 text-green-600 border-gray-300 rounded" />
						</div>
						<div class="ml-3 text-sm">
							<label
								for="consent"
								class="font-medium text-gray-700"
								>I acknowledge that the information provided is
								accurate to the best of my knowledge.</label
							>
						</div>
					</div>
				</section>

				<div class="flex justify-end space-x-4">
					<button
						type="reset"
						class="px-6 py-2 border border-gray-300 rounded-md shadow-sm text-base font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150">
						Clear Form
					</button>
					<button
						type="submit"
						class="px-6 py-2 border border-transparent rounded-md shadow-sm text-base font-medium text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition duration-150">
						Submit Questionnaire
					</button>
				</div>
			</form>
		</div>

		<script>
			// REPLACE THE FOLLOWING URL WITH YOUR DEPLOYED GOOGLE APPS SCRIPT URL
			const SCRIPT_URL =
				"https://script.google.com/macros/s/AKfycbwiB1aa3ucgUjSYgqyFXyXa4dB5tfg_GkLAA4hTdPZLnLdLgYxBZuvO3NLPn19PnJFi4w/exec";

			function handleFormSubmit(event) {
				event.preventDefault(); // Prevent default form submission

				const form = document.getElementById("healthQuestionnaire");
				const formData = new FormData(form);
				const data = {};

				// Handle standard form fields
				for (const [key, value] of formData.entries()) {
					if (key.endsWith("[]")) {
						const baseKey = key.slice(0, -2);
						if (!data[baseKey]) {
							data[baseKey] = [];
						}
						data[baseKey].push(value);
					} else {
						data[key] = value;
					}
				}

				// Convert the object to a format suitable for the Apps Script
				const payload = {
					data: JSON.stringify(data),
					timestamp: new Date().toISOString()
				};

				const submitButton = event.target.querySelector(
					'button[type="submit"]'
				);
				submitButton.disabled = true;
				submitButton.textContent = "Submitting...";

				// Send the data to the Google Apps Script
				fetch(SCRIPT_URL, {
					method: "POST",
					mode: "no-cors", // Required for Google Apps Script
					cache: "no-cache",
					headers: {
						"Content-Type": "application/json"
					},
					body: JSON.stringify(payload)
				})
					.then((response) => {
						const message =
							"Thank you for submitting the questionnaire! Your information has been recorded.";
						showModal(message);
						form.reset(); // Clear the form after submission
					})
					.catch((error) => {
						console.error("Submission error:", error);
						const errorMessage =
							"There was an error submitting your form. Please try again.";
						showModal(errorMessage);
					})
					.finally(() => {
						submitButton.disabled = false;
						submitButton.textContent = "Submit Questionnaire";
					});
			}

			function showModal(message) {
				const modal = document.createElement("div");
				modal.style.position = "fixed";
				modal.style.top = "0";
				modal.style.left = "0";
				modal.style.width = "100%";
				modal.style.height = "100%";
				modal.style.backgroundColor = "rgba(0, 0, 0, 0.5)";
				modal.style.display = "flex";
				modal.style.justifyContent = "center";
				modal.style.alignItems = "center";
				modal.style.zIndex = "1000";

				modal.innerHTML = `
                <div class="bg-white rounded-lg p-8 shadow-2xl max-w-sm mx-4">
                    <p class="text-center text-lg font-medium text-gray-800">${message}</p>
                    <div class="flex justify-center mt-6">
                        <button onclick="this.closest('.bg-white').parentElement.remove()" class="px-6 py-2 rounded-md shadow-sm text-white bg-green-600 hover:bg-green-700 transition duration-150">OK</button>
                    </div>
                </div>
            `;
				document.body.appendChild(modal);
			}

			function addPainPoint() {
				const container = document.getElementById(
					"painPointsContainer"
				);
				const newIndex = container.children.length + 1;
				const newPainPoint = document.createElement("div");
				newPainPoint.className =
					"bg-gray-50 p-4 rounded-lg border border-gray-200 shadow-sm";
				newPainPoint.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <h4 class="font-medium text-gray-700">Area of Concern #${newIndex}</h4>
                    <button type="button" onclick="removePainPoint(this)" class="text-red-500 hover:text-red-700 text-sm font-medium">Remove</button>
                </div>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Area of Symptom/Condition</label>
                        <input type="text" name="painArea[]" required class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700">Severity Level (0-10)</label>
                        <input type="range" name="painLevel[]" min="0" max="10" value="0" oninput="this.nextElementSibling.value = this.value" class="w-full mt-2">
                        <output class="text-center block text-sm font-mono mt-1">0</output>
                    </div>
                    <div class="col-span-1 sm:col-span-2">
                        <label class="block text-sm font-medium text-gray-700">Describe the symptom or condition</label>
                        <textarea name="painDescription[]" rows="2" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-green-500 focus:ring focus:ring-green-500 focus:ring-opacity-50 transition duration-150"></textarea>
                    </div>
                </div>
            `;
				container.appendChild(newPainPoint);
			}

			function removePainPoint(button) {
				const painPointDiv = button.closest("div.bg-gray-50");
				painPointDiv.remove();

				// Re-number the pain points
				const container = document.getElementById(
					"painPointsContainer"
				);
				const painPoints = container.children;
				for (let i = 0; i < painPoints.length; i++) {
					const header = painPoints[i].querySelector("h4");
					header.textContent = `Area of Concern #${i + 1}`;
				}
			}
		</script>
	</body>
</html>
